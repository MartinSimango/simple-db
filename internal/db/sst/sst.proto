syntax = "proto3";

package sst;
option go_package = "github.com/MartinSimango/simple-db/internal/db/sst;sst";

import "internal/db/record.proto";

message BlockEntry {
    bytes unshared_key = 1;
    uint32 shared_key_len = 2;
    bytes value = 3;
    db.RecordType record_type = 4;

}

message BlockHandle {
    fixed32 offset = 1;
    fixed32 size   = 2;
}

message IndexEntry {
    bytes unshared_key  = 1;       
    uint32 shared_key_len = 2;      
    BlockHandle block_handle = 3;  
}

message DataBlock {
    repeated BlockEntry entries = 1;
    repeated uint32 restart_points = 2;
    uint32 restart_count = 3;
}

message IndexBlock {
    repeated IndexEntry entries = 1;
    repeated uint32 restart_points = 2;
    uint32 restart_count = 3;
}


message Footer {
    BlockHandle blockHandle = 1;
    fixed32 Version     = 2;
    fixed64 Magic       = 3;
}